<!-- <section class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-md-12">
        <div class="card card-primary">
          <div class="card-header">
            <h3 class="card-title">Voucher</h3>
          </div>
          <form>
            <div class="card-body">
              <div class="row">
                <div class="col-6">

                  <div class="form-group">
                    <label for="name">Tên</label>
                    <input type="text" class="form-control" id="name" 
                      [(ngModel)]="voucher.name" placeholder="Tên" (keydown)="revoveInvalid(validName)"
                      (blur)="validateName()" />
                    <div class="validate-input" *ngIf="!validName.done">
                      <p class="validate-input-label" *ngIf="validName.empty">Tên không để trống</p>
                      <p class="validate-input-label" *ngIf="validName.maxLength">Tên tối đa 250 kí tự</p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="startDate">Ngày bắt đầu</label>
                    <input type="datetime-local" class="form-control" 
                      id="startDate" [(ngModel)]="voucher.startDate" name="startDate" (blur)="isStartDateValid()"
                      (keydown)="removeCheckStartDate()" />
                    <div>
                      <div class="validate-input-label" *ngIf="checkStartDateNull">
                        Vui lòng chọn ngày bắt đầu.
                      </div>
                      <div class="validate-input-label" *ngIf="checkStartDate">
                        Ngày bắt đầu phải lớn hơn hoặc bằng ngày hiện tại.
                      </div>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="endDate">Ngày kết thúc</label>
                    <input type="datetime-local" class="form-control" 
                      id="endDate" [(ngModel)]="voucher.endDate" name="endDate" required (blur)="isEndDateValid()"
                      (keydown)="removeCheckEndDate()" />
                    <div>
                      <div class="validate-input-label" *ngIf="checkEndDateNull">
                        Vui lòng chọn ngày kết thúc.
                      </div>
                      <div class="validate-input-label" *ngIf="checkEndDate">
                        Ngày kết thúc phải lớn hơn ngày bắt đầu.
                      </div>
                    </div>
                  </div

                  <div class="form-group">
                    <label for="description">Nội dung</label>
                    <input type="text" class="form-control" id="description" 
                      [(ngModel)]="voucher.description" placeholder="Nội dung"
                      (keydown)="revoveInvalid(validDescription)" (blur)="validateDescription()" />
                    <div class="validate-input" *ngIf="!validDescription.done">
                      <p class="validate-input-label" *ngIf="validDescription.empty">Nội dung không để trống</p>
                      <p class="validate-input-label" *ngIf="validDescription.maxLength">Nội dung tối đa 250 kí tự</p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="condition">Điều kiện sử dụng</label>
                    <input type="number" class="form-control" id="condition" [(ngModel)]="voucher.conditionApply"
                      name="condition" placeholder="Giá trị đơn hàng" required
                      (keydown)="revoveInvalid(validconditionApply)" (blur)="validateConditionApply()" />
                    <div class="validate-input" *ngIf="!validconditionApply.done">
                      <p class="validate-input-label" *ngIf="validconditionApply.empty">Điều kiện sử dụng không để trống
                      </p>
                      <p class="validate-input-label" *ngIf="validconditionApply.regex">Điều kiện sử dụng phải là số
                        dương</p>
                    </div>
                  </div>

                </div>

                <div class="col-6">

                  <div class="form-group">
                    <label for="discountType">Loại voucher</label>
                    <select class="form-control" id="discountType" 
                      [(ngModel)]="voucher.voucherType">
                      <option value="1" slected>Theo %</option>
                      <option value="0">Theo tiền</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="reducedValue">Giá trị giảm</label>
                    <input type="number" class="form-control" id="reducedValue" 
                      [(ngModel)]="voucher.reducedValue" placeholder="Giá trị giảm"
                      [max]="voucher.voucherType === '1' ? 100 : null" (keydown)="revoveInvalid(validReducedValue)"
                      (blur)="validateReducedValue()" />
                    <div *ngIf="voucher.voucherType === '1' && voucher.reducedValue > 100 ">
                      Giá trị giảm không được quá 100%
                    </div>
                    <div class="validate-input" *ngIf="!validReducedValue.done">
                      <p class="validate-input-label" *ngIf="validReducedValue.empty">Giá trị giảm không để trống</p>
                      <p class="validate-input-label" *ngIf="validReducedValue.regex">Giá trị giảm phải là số dương</p>
                    </div>
                  </div>

                  <div class="form-group" *ngIf="voucher.voucherType == '1'">
                    <label for="maxReduced">Giá trị giảm tối đa</label>
                    <input type="text" class="form-control" id="maxReduced" 
                      [(ngModel)]="voucher.maxReduced" placeholder="Giá trị giảm tối đa"
                      (keydown)="revoveInvalid(validMaxReduced)" (blur)="validateMaxReducedValue()" />
                    <div class="validate-input" *ngIf="!validMaxReduced.done">
                      <p class="validate-input-label" *ngIf="validMaxReduced.empty">Giá trị giảm tối đa không để trống
                      </p>
                      <p class="validate-input-label" *ngIf="validMaxReduced.regex">Giá trị giảm tối đa phải là số dương
                      </p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="quantity">Số lượng</label>
                    <input type="number" class="form-control" id="quantity" 
                      [(ngModel)]="voucher.quantity" placeholder="Số lượng" (keydown)="revoveInvalid(validQuantity)"
                      (blur)="validateQuantity()" />
                    <div class="validate-input" *ngIf="!validQuantity.done">
                      <p class="validate-input-label" *ngIf="validQuantity.empty">Số lượng không để trống</p>
                      <p class="validate-input-label" *ngIf="validQuantity.regex">Số lượng phải lớn hơn 0</p>
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="discountType">Nơi áp dụng</label>
                    <select class="form-control" id="kkad" 
                      [(ngModel)]="voucher.apply">
                      <option value="2" selected>Tất cả mọi nơi</option>
                      <option value="0">Tại cửa hàng</option>
                      <option value="1">Mua online</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label for="discountType">Khách hàng áp dụng</label>
                    <select class="form-control" id="kkad" 
                      [(ngModel)]="voucher.optionCustomer">
                      <option value="0" selected>Tất cả khách hàng</option>
                      <option value="1">Tùy chọn</option>
                    </select>
                  </div>

                </div>

                <div class="form-group" *ngIf="voucher.optionCustomer == 1">
                  <label for="customer">Khách hàng</label>
                  <div class="grid">
                    <ag-grid-angular style="width: 100%; height: 300px" class="ag-theme-balham" [rowData]="rowData"
                      [columnDefs]="columnDefs" [rowSelection]="rowSelection" [headerHeight]="headerHeight"
                      [rowHeight]="rowHeight" [pagination]="true" [paginationPageSize]="5" [domLayout]="'autoHeight'"
                      (gridReady)="onGridReady($event)"></ag-grid-angular>
                  </div>
                </div>

                <div class="form-group" *ngIf="voucher.optionCustomer == 1">
                  <label for="limitCustomer">Giới hạn số lần sử dụng với mỗi khách hàng</label>
                  <input type="number" class="form-control" id="limitCustomer" 
                    [(ngModel)]="voucher.limitCustomer" placeholder="Số lần sử dụng" />
                </div>

                <div class="form-group">
                  <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" 
                      [(ngModel)]="voucher.allow" id="allow" (change)="toggleAllowDiscount($event)" checked>
                    <label class="form-check-label" for="allow">
                      Cho phép xử dụng cùng giảm giá
                    </label>
                  </div>
                </div>
                <div class="card-footer">
                  <button type="submit" class="btn btn-primary" (click)="addVoucher()">Submit</button>
                </div>
              </div>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</section> -->

<h1 mat-dialog-title>Thêm Voucher</h1>

<div mat-dialog-content class="example-container" style="display: flex; flex-wrap: wrap;">
  <div style="flex: 1 1 50%; padding-right: 10px;">

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Tên</mat-label>
      <input matInput [(ngModel)]="Name" name="Name" placeholder="Tên" (keydown)="revoveInvalid(validName)"
        (blur)="validateName()">
      <div class="validate-input" *ngIf="!validName.done">
        <p class="validate-input-label" *ngIf="validName.empty">Tên không được để trống</p>
        <p class="validate-input-label" *ngIf="validName.maxLength">Tên sản phẩm dưới 250 kí tự</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Ngày bắt đầu</mat-label>
      <input matInput type="datetime-local" [(ngModel)]="StartDate" name="StartDate" (keydown)="removeCheckStartDate()"
        (blur)="isStartDateValid()">
      <div class="validate-input">
        <p class="validate-input-label" *ngIf="checkStartDateNull">Vui lòng chọn ngày bắt đầu</p>
        <p class="validate-input-label" *ngIf="checkStartDate">Ngày bắt đầu phải lớn hơn hoặc bằng ngày hiện tại</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Ngày kết thúc</mat-label>
      <input type="datetime-local" [(ngModel)]="EndDate" name="EndDate" matInput (keydown)="removeCheckEndDate()"
        (blur)="isEndDateValid()">
      <div class="validate-input">
        <p class="validate-input-label" *ngIf="checkEndDateNull">Vui lòng chọn ngày kết thúc</p>
        <p class="validate-input-label" *ngIf="checkEndDate">Ngày kết thúc phải lớn hơn ngày bắt đầu</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Nội dung</mat-label>
      <input matInput [(ngModel)]="Description" name="Description" placeholder="Nội dung"
        (keydown)="revoveInvalid(validDescription)" (blur)="validateDescription()">
      <div class="validate-input" *ngIf="!validDescription.done">
        <p class="validate-input-label" *ngIf="validDescription.empty">Nội dung không để trống</p>
        <p class="validate-input-label" *ngIf="validDescription.maxLength">Nội dung tối đa 250 kí tự</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Điều kiện sử dụng</mat-label>
      <input matInput type="number" [(ngModel)]="ConditionApply" name="ConditionApply" placeholder="Điều kiện sử dụng"
        (keydown)="revoveInvalid(validconditionApply)" (blur)="validateConditionApply()">
      <div class="validate-input" *ngIf="!validconditionApply.done">
        <p class="validate-input-label" *ngIf="validconditionApply.empty">Điều kiện sử dụng không để trống</p>
        <p class="validate-input-label" *ngIf="validconditionApply.regex">Điều kiện sử dụng phải là số dương</p>
      </div>
    </mat-form-field>
  </div>

  <div style="flex: 1 1 50%; padding-left: 10px;">
    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Loại voucher</mat-label>
      <mat-select matInput [(ngModel)]="VoucherType">
        <mat-option [value]="1">Theo %</mat-option>
        <mat-option [value]="0">Theo tiền</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Giá trị giảm</mat-label>
      <input matInput type="number" [(ngModel)]="ReducedValue" name="ReducedValue" placeholder="Giá trị giảm"
        (keydown)="revoveInvalid(validReducedValue)" (blur)="validateReducedValue()">
      <div *ngIf="VoucherType === 1 && ReducedValue > 100">
        Giá trị giảm không được quá 100%
      </div>
      <div class="validate-input" *ngIf="!validReducedValue.done">
        <p class="validate-input-label" *ngIf="validReducedValue.empty">Giá trị giảm không để trống</p>
        <p class="validate-input-label" *ngIf="validReducedValue.regex">Giá trị giảm phải là số dương</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width" *ngIf="VoucherType === 1">
      <mat-label>Giá trị giảm tối đa</mat-label>
      <input matInput type="number" [(ngModel)]="MaxReduced" name="MaxReduced" placeholder="Giá trị giảm tối đa"
        (keydown)="revoveInvalid(validMaxReduced)" (blur)="validateMaxReducedValue()">
      <div class="validate-input" *ngIf="!validMaxReduced.done">
        <p class="validate-input-label" *ngIf="validMaxReduced.empty">Giá trị giảm tối đa không để trống</p>
        <p class="validate-input-label" *ngIf="validMaxReduced.regex">Giá trị giảm tối đa phải là số dương</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Số lượng</mat-label>
      <input matInput type="number" [(ngModel)]="Quantity" name="Quantity" placeholder="Số lượng"
        (keydown)="revoveInvalid(validQuantity)" (blur)="validateQuantity()">
      <div class="validate-input" *ngIf="!validQuantity.done">
        <p class="validate-input-label" *ngIf="validQuantity.empty">Số lượng sử dụng không để trống</p>
        <p class="validate-input-label" *ngIf="validQuantity.regex">Số lượng phải lớn hơn 0</p>
      </div>
    </mat-form-field>

    <mat-form-field appearance="outline" class="example-full-width">
      <mat-label>Nơi áp dụng</mat-label>
      <mat-select matInput [(ngModel)]="Apply">
        <mat-option [value]="2">Tất cả mọi nơi</mat-option>
        <mat-option [value]="0">Tại cửa hàng</mat-option>
        <mat-option [value]="1">Mua online</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Khách hàng áp dụng</mat-label>
      <mat-select matInput [(ngModel)]="OptionCustomer">
        <mat-option [value]="0">Tất cả khách hàng</mat-option>
        <mat-option [value]="1">Tùy chọn</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
</div>

<div style="flex-basis: 100%; width: 100%;">
  <div class="form-group" *ngIf="OptionCustomer === 1" style="margin-bottom: 0;">
    <label for="customer">Khách hàng</label>
    <div class="grid">
      <ag-grid-angular style="width: 100%; height: 300px" class="ag-theme-balham" [rowData]="rowData"
        [columnDefs]="columnDefs" [rowSelection]="rowSelection" [headerHeight]="headerHeight" [rowHeight]="rowHeight"
        [pagination]="true" [paginationPageSize]="5" (gridReady)="onGridReady($event)"></ag-grid-angular>
    </div>
  </div>

  <mat-form-field appearance="outline" *ngIf="OptionCustomer == 1" style="width: 45%;">
    <mat-label>Giới hạn số lần sử dụng với mỗi khách hàng</mat-label>
    <input matInput type="number" [(ngModel)]="LimitCustomer" name="LimitCustomer" placeholder="Số lần sử dụng"
      (keydown)="OptionCustomer == 1 && revoveInvalid(validLimitCustomer)" (blur)="validateLimitCustomer()">
    <div class="validate-input" *ngIf="OptionCustomer == 1 && !validLimitCustomer.done">
      <p class="validate-input-label" *ngIf="validLimitCustomer.empty">Số lượng sử dụng không để trống</p>
      <p class="validate-input-label" *ngIf="validLimitCustomer.regex">Số lượng phải lớn hơn 0</p>
    </div>
  </mat-form-field>

  <!-- <mat-form-field appearance="outline">
    <mat-label>Cho phép sử dụng cùng giảm giá</mat-label>
    <mat-checkbox [(ngModel)]="voucher.allow" id="allow" (change)="toggleAllowDiscount($event)" checked></mat-checkbox>
  </mat-form-field> -->
</div>

<br>

<div mat-dialog-actions [align]="'end'">
  <button mat-raised-button color="warn" mat-dialog-close>Thoát</button>
  <button mat-raised-button color="primary" (click)="addVoucher()">Thêm</button>
</div>